{
    "openapi": "3.0.2",
    "info": {
        "title": "Movie Service API",
        "version": "2023-01-01",
        "description": "A comprehensive service for managing movie rentals with catalog and transaction processing. This service provides movie catalog management (CRUD operations), rental transaction processing, inventory tracking and availability management, late fee calculation and payment processing, and user rental history and status tracking."
    },
    "paths": {
        "/movies": {
            "get": {
                "description": "Lists movies with filtering and pagination. Returns a paginated list of movies with optional filtering by genre and director. Supports pagination for efficient catalog browsing.",
                "operationId": "ListMovies",
                "parameters": [
                    {
                        "name": "page",
                        "in": "query",
                        "schema": {
                            "type": "number"
                        }
                    },
                    {
                        "name": "size",
                        "in": "query",
                        "schema": {
                            "type": "number"
                        }
                    },
                    {
                        "name": "genre",
                        "in": "query",
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "director",
                        "in": "query",
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "ListMovies 200 response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ListMoviesResponseContent"
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "description": "Creates a new movie in the rental catalog with complete information including title, director, genre, release year, duration, available copies, and rental price. Validates movie information and ensures no duplicate titles exist.",
                "operationId": "CreateMovie",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CreateMovieRequestContent"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "CreateMovie 200 response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/CreateMovieResponseContent"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "ValidationError 400 response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ValidationErrorResponseContent"
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "ConflictError 409 response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ConflictErrorResponseContent"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/movies/{movieId}": {
            "delete": {
                "description": "Removes a movie from the catalog. Permanently removes a movie from the rental catalog. This operation should only be performed if no active rentals exist for the movie.",
                "operationId": "DeleteMovie",
                "parameters": [
                    {
                        "name": "movieId",
                        "in": "path",
                        "schema": {
                            "type": "string"
                        },
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "DeleteMovie 200 response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/DeleteMovieResponseContent"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "NotFoundError 404 response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/NotFoundErrorResponseContent"
                                }
                            }
                        }
                    }
                }
            },
            "get": {
                "description": "Retrieves a movie by its unique identifier. Returns complete movie information including availability status, rental price, and current inventory levels.",
                "operationId": "GetMovie",
                "parameters": [
                    {
                        "name": "movieId",
                        "in": "path",
                        "schema": {
                            "type": "string"
                        },
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "GetMovie 200 response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/GetMovieResponseContent"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "NotFoundError 404 response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/NotFoundErrorResponseContent"
                                }
                            }
                        }
                    }
                }
            },
            "put": {
                "description": "Updates an existing movie's information. Allows partial updates to movie catalog information including title, director, genre, availability, and pricing. All fields are optional.",
                "operationId": "UpdateMovie",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/UpdateMovieRequestContent"
                            }
                        }
                    }
                },
                "parameters": [
                    {
                        "name": "movieId",
                        "in": "path",
                        "schema": {
                            "type": "string"
                        },
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "UpdateMovie 200 response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/UpdateMovieResponseContent"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "ValidationError 400 response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ValidationErrorResponseContent"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "NotFoundError 404 response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/NotFoundErrorResponseContent"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/rentals": {
            "get": {
                "description": "Lists rental transactions with filtering and pagination. Returns a paginated list of rentals with optional filtering by user ID and rental status. Useful for rental history and management.",
                "operationId": "ListRentals",
                "parameters": [
                    {
                        "name": "page",
                        "in": "query",
                        "schema": {
                            "type": "number"
                        }
                    },
                    {
                        "name": "size",
                        "in": "query",
                        "schema": {
                            "type": "number"
                        }
                    },
                    {
                        "name": "userId",
                        "in": "query",
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "status",
                        "in": "query",
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "ListRentals 200 response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ListRentalsResponseContent"
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "description": "Creates a new movie rental transaction. Processes a new rental request by checking movie availability, calculating rental price based on duration, and creating a rental record with due date calculation. Updates movie inventory automatically.",
                "operationId": "CreateRental",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CreateRentalRequestContent"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "CreateRental 200 response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/CreateRentalResponseContent"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "ValidationError 400 response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ValidationErrorResponseContent"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "NotFoundError 404 response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/NotFoundErrorResponseContent"
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "ConflictError 409 response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ConflictErrorResponseContent"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/rentals/{rentalId}": {
            "get": {
                "description": "Retrieves a rental transaction by its unique identifier. Returns complete rental information including dates, pricing, late fees, and current status.",
                "operationId": "GetRental",
                "parameters": [
                    {
                        "name": "rentalId",
                        "in": "path",
                        "schema": {
                            "type": "string"
                        },
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "GetRental 200 response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/GetRentalResponseContent"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "NotFoundError 404 response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/NotFoundErrorResponseContent"
                                }
                            }
                        }
                    }
                }
            },
            "put": {
                "description": "Updates a rental transaction (typically for returns). Updates rental information including return date, late fees, and status. Automatically calculates late fees based on return date and updates movie inventory when rental is returned.",
                "operationId": "UpdateRental",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/UpdateRentalRequestContent"
                            }
                        }
                    }
                },
                "parameters": [
                    {
                        "name": "rentalId",
                        "in": "path",
                        "schema": {
                            "type": "string"
                        },
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "UpdateRental 200 response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/UpdateRentalResponseContent"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "NotFoundError 404 response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/NotFoundErrorResponseContent"
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "components": {
        "schemas": {
            "ConflictErrorResponseContent": {
                "type": "object",
                "properties": {
                    "message": {
                        "type": "string"
                    }
                },
                "required": [
                    "message"
                ]
            },
            "CreateMovieRequestContent": {
                "type": "object",
                "properties": {
                    "title": {
                        "type": "string"
                    },
                    "director": {
                        "type": "string"
                    },
                    "genre": {
                        "type": "string"
                    },
                    "releaseYear": {
                        "type": "number"
                    },
                    "duration": {
                        "type": "number"
                    },
                    "description": {
                        "type": "string"
                    },
                    "availableCopies": {
                        "type": "number"
                    },
                    "rentalPrice": {
                        "type": "number",
                        "format": "double"
                    }
                },
                "required": [
                    "availableCopies",
                    "director",
                    "duration",
                    "genre",
                    "releaseYear",
                    "rentalPrice",
                    "title"
                ]
            },
            "CreateMovieResponseContent": {
                "type": "object",
                "properties": {
                    "movieId": {
                        "type": "string"
                    },
                    "title": {
                        "type": "string"
                    },
                    "director": {
                        "type": "string"
                    },
                    "genre": {
                        "type": "string"
                    },
                    "releaseYear": {
                        "type": "number"
                    },
                    "duration": {
                        "type": "number"
                    },
                    "description": {
                        "type": "string"
                    },
                    "availableCopies": {
                        "type": "number"
                    },
                    "rentalPrice": {
                        "type": "number",
                        "format": "double"
                    },
                    "createdAt": {
                        "type": "string"
                    },
                    "status": {
                        "type": "string"
                    }
                },
                "required": [
                    "availableCopies",
                    "createdAt",
                    "director",
                    "duration",
                    "genre",
                    "movieId",
                    "releaseYear",
                    "rentalPrice",
                    "status",
                    "title"
                ]
            },
            "CreateRentalRequestContent": {
                "type": "object",
                "properties": {
                    "movieId": {
                        "type": "string"
                    },
                    "userId": {
                        "type": "string"
                    },
                    "rentalDays": {
                        "type": "number"
                    }
                },
                "required": [
                    "movieId",
                    "rentalDays",
                    "userId"
                ]
            },
            "CreateRentalResponseContent": {
                "type": "object",
                "properties": {
                    "rentalId": {
                        "type": "string"
                    },
                    "movieId": {
                        "type": "string"
                    },
                    "userId": {
                        "type": "string"
                    },
                    "rentalDate": {
                        "type": "string"
                    },
                    "dueDate": {
                        "type": "string"
                    },
                    "totalPrice": {
                        "type": "number",
                        "format": "double"
                    },
                    "createdAt": {
                        "type": "string"
                    },
                    "status": {
                        "type": "string"
                    }
                },
                "required": [
                    "createdAt",
                    "dueDate",
                    "movieId",
                    "rentalDate",
                    "rentalId",
                    "status",
                    "totalPrice",
                    "userId"
                ]
            },
            "DeleteMovieResponseContent": {
                "type": "object",
                "properties": {
                    "deleted": {
                        "type": "boolean"
                    },
                    "message": {
                        "type": "string"
                    }
                },
                "required": [
                    "deleted",
                    "message"
                ]
            },
            "GetMovieResponseContent": {
                "type": "object",
                "properties": {
                    "movieId": {
                        "type": "string"
                    },
                    "title": {
                        "type": "string"
                    },
                    "director": {
                        "type": "string"
                    },
                    "genre": {
                        "type": "string"
                    },
                    "releaseYear": {
                        "type": "number"
                    },
                    "duration": {
                        "type": "number"
                    },
                    "description": {
                        "type": "string"
                    },
                    "availableCopies": {
                        "type": "number"
                    },
                    "rentalPrice": {
                        "type": "number",
                        "format": "double"
                    },
                    "createdAt": {
                        "type": "string"
                    },
                    "updatedAt": {
                        "type": "string"
                    },
                    "status": {
                        "type": "string"
                    }
                },
                "required": [
                    "availableCopies",
                    "createdAt",
                    "director",
                    "duration",
                    "genre",
                    "movieId",
                    "releaseYear",
                    "rentalPrice",
                    "status",
                    "title",
                    "updatedAt"
                ]
            },
            "GetRentalResponseContent": {
                "type": "object",
                "properties": {
                    "rentalId": {
                        "type": "string"
                    },
                    "movieId": {
                        "type": "string"
                    },
                    "userId": {
                        "type": "string"
                    },
                    "rentalDate": {
                        "type": "string"
                    },
                    "dueDate": {
                        "type": "string"
                    },
                    "returnDate": {
                        "type": "string"
                    },
                    "totalPrice": {
                        "type": "number",
                        "format": "double"
                    },
                    "lateFee": {
                        "type": "number",
                        "format": "double"
                    },
                    "createdAt": {
                        "type": "string"
                    },
                    "updatedAt": {
                        "type": "string"
                    },
                    "status": {
                        "type": "string"
                    }
                },
                "required": [
                    "createdAt",
                    "dueDate",
                    "movieId",
                    "rentalDate",
                    "rentalId",
                    "status",
                    "totalPrice",
                    "updatedAt",
                    "userId"
                ]
            },
            "ListMoviesResponseContent": {
                "type": "object",
                "properties": {
                    "movies": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/MovieResponse"
                        }
                    },
                    "page": {
                        "type": "number"
                    },
                    "size": {
                        "type": "number"
                    },
                    "total": {
                        "type": "number"
                    },
                    "totalPages": {
                        "type": "number"
                    }
                },
                "required": [
                    "movies",
                    "page",
                    "size",
                    "total",
                    "totalPages"
                ]
            },
            "ListRentalsResponseContent": {
                "type": "object",
                "properties": {
                    "rentals": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/RentalResponse"
                        }
                    },
                    "page": {
                        "type": "number"
                    },
                    "size": {
                        "type": "number"
                    },
                    "total": {
                        "type": "number"
                    },
                    "totalPages": {
                        "type": "number"
                    }
                },
                "required": [
                    "page",
                    "rentals",
                    "size",
                    "total",
                    "totalPages"
                ]
            },
            "MovieResponse": {
                "type": "object",
                "properties": {
                    "movieId": {
                        "type": "string"
                    },
                    "title": {
                        "type": "string"
                    },
                    "director": {
                        "type": "string"
                    },
                    "genre": {
                        "type": "string"
                    },
                    "releaseYear": {
                        "type": "number"
                    },
                    "duration": {
                        "type": "number"
                    },
                    "description": {
                        "type": "string"
                    },
                    "availableCopies": {
                        "type": "number"
                    },
                    "rentalPrice": {
                        "type": "number",
                        "format": "double"
                    },
                    "createdAt": {
                        "type": "string"
                    },
                    "updatedAt": {
                        "type": "string"
                    },
                    "status": {
                        "type": "string"
                    }
                },
                "required": [
                    "availableCopies",
                    "createdAt",
                    "director",
                    "duration",
                    "genre",
                    "movieId",
                    "releaseYear",
                    "rentalPrice",
                    "status",
                    "title",
                    "updatedAt"
                ]
            },
            "NotFoundErrorResponseContent": {
                "type": "object",
                "properties": {
                    "message": {
                        "type": "string"
                    }
                },
                "required": [
                    "message"
                ]
            },
            "RentalResponse": {
                "type": "object",
                "properties": {
                    "rentalId": {
                        "type": "string"
                    },
                    "movieId": {
                        "type": "string"
                    },
                    "userId": {
                        "type": "string"
                    },
                    "rentalDate": {
                        "type": "string"
                    },
                    "dueDate": {
                        "type": "string"
                    },
                    "returnDate": {
                        "type": "string"
                    },
                    "totalPrice": {
                        "type": "number",
                        "format": "double"
                    },
                    "lateFee": {
                        "type": "number",
                        "format": "double"
                    },
                    "createdAt": {
                        "type": "string"
                    },
                    "updatedAt": {
                        "type": "string"
                    },
                    "status": {
                        "type": "string"
                    }
                },
                "required": [
                    "createdAt",
                    "dueDate",
                    "movieId",
                    "rentalDate",
                    "rentalId",
                    "status",
                    "totalPrice",
                    "updatedAt",
                    "userId"
                ]
            },
            "UpdateMovieRequestContent": {
                "type": "object",
                "properties": {
                    "title": {
                        "type": "string"
                    },
                    "director": {
                        "type": "string"
                    },
                    "genre": {
                        "type": "string"
                    },
                    "releaseYear": {
                        "type": "number"
                    },
                    "duration": {
                        "type": "number"
                    },
                    "description": {
                        "type": "string"
                    },
                    "availableCopies": {
                        "type": "number"
                    },
                    "rentalPrice": {
                        "type": "number",
                        "format": "double"
                    }
                }
            },
            "UpdateMovieResponseContent": {
                "type": "object",
                "properties": {
                    "movieId": {
                        "type": "string"
                    },
                    "title": {
                        "type": "string"
                    },
                    "director": {
                        "type": "string"
                    },
                    "genre": {
                        "type": "string"
                    },
                    "releaseYear": {
                        "type": "number"
                    },
                    "duration": {
                        "type": "number"
                    },
                    "description": {
                        "type": "string"
                    },
                    "availableCopies": {
                        "type": "number"
                    },
                    "rentalPrice": {
                        "type": "number",
                        "format": "double"
                    },
                    "updatedAt": {
                        "type": "string"
                    },
                    "status": {
                        "type": "string"
                    }
                },
                "required": [
                    "availableCopies",
                    "director",
                    "duration",
                    "genre",
                    "movieId",
                    "releaseYear",
                    "rentalPrice",
                    "status",
                    "title",
                    "updatedAt"
                ]
            },
            "UpdateRentalRequestContent": {
                "type": "object",
                "properties": {
                    "returnDate": {
                        "type": "string"
                    },
                    "lateFee": {
                        "type": "number",
                        "format": "double"
                    },
                    "status": {
                        "type": "string"
                    }
                }
            },
            "UpdateRentalResponseContent": {
                "type": "object",
                "properties": {
                    "rentalId": {
                        "type": "string"
                    },
                    "returnDate": {
                        "type": "string"
                    },
                    "lateFee": {
                        "type": "number",
                        "format": "double"
                    },
                    "totalAmount": {
                        "type": "number",
                        "format": "double"
                    },
                    "createdAt": {
                        "type": "string"
                    },
                    "updatedAt": {
                        "type": "string"
                    },
                    "status": {
                        "type": "string"
                    }
                },
                "required": [
                    "createdAt",
                    "lateFee",
                    "rentalId",
                    "returnDate",
                    "status",
                    "totalAmount",
                    "updatedAt"
                ]
            },
            "ValidationErrorResponseContent": {
                "type": "object",
                "properties": {
                    "message": {
                        "type": "string"
                    },
                    "field": {
                        "type": "string"
                    }
                },
                "required": [
                    "field",
                    "message"
                ]
            }
        }
    }
}
